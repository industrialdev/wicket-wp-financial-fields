document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".hyperpress-map-canvas");0!==e.length&&e.forEach((function(e){const t=e.dataset.field,n=parseFloat(e.dataset.lat)||51.505,a=parseFloat(e.dataset.lng)||-.09,o=parseInt(e.dataset.zoom,10)||13,r=document.getElementById(t+"_lat"),s=document.getElementById(t+"_lng"),l=document.getElementById(t+"_address"),d=L.map(e).setView([n,a],o);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d);let c=L.marker([n,a],{draggable:!0}).addTo(d);c.on("dragend",(function(e){const t=c.getLatLng();r.value=t.lat,s.value=t.lng})),d.on("click",(function(e){const t=e.latlng;c.setLatLng(t),r.value=t.lat,s.value=t.lng}));const g=document.querySelector(`.hyperpress-geocode-button[data-field="${t}"]`);g&&g.addEventListener("click",(function(){const e=l.value;e&&fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(e)}`).then((e=>e.json())).then((e=>{if(e&&e.length>0){const t=parseFloat(e[0].lat),n=parseFloat(e[0].lon),a=new L.LatLng(t,n);d.setView(a,o),c.setLatLng(a),r.value=t,s.value=n}else alert("Address not found.")})).catch((e=>console.error("Error during geocoding:",e)))}))}))}));